Використовуємо пристрій: cpu
Створення завантажувачів з розміром зображень: 128
Завантаження датасету для типу ризику: diseases
Розмір зображень: 128x128
Завантажено ризиків: 156
Завантажено зображень: 152
Знайдено класів: 102
Валідних зображень: 152
Після фільтрації: 60 зразків
Завантаження датасету для типу ризику: diseases
Розмір зображень: 128x128
Завантажено ризиків: 156
Завантажено зображень: 152
Знайдено класів: 102
Валідних зображень: 152
Завантаження датасету для типу ризику: diseases
Розмір зображень: 128x128
Завантажено ризиків: 156
Завантажено зображень: 152
Знайдено класів: 102
Валідних зображень: 152
Фінальна статистика:
  Тренувальна вибірка: 48 зразків
  Валідаційна вибірка: 12 зразків
  Кількість класів: 20
Створення просунутої моделі efficientnet_b0
Спроба створення EfficientNet через timm...
✅ EfficientNet створено без pretrained вагів
Модель заморожена для градуального розморожування
Використовуємо Focal Loss
Використовуємо Cosine Annealing LR
Епоха 1/80
Навчання епоха 1: 100%|██████████| 4/4 [00:28<00:00,  7.15s/it, loss=3.86, acc=0.0831, lr=0.0005]
Валідація з TTA: 100%|██████████| 1/1 [00:28<00:00, 28.17s/it]
Train Loss: 3.9914, Train Acc: 0.0831
Val Loss: 2.7415, Val Acc: 0.0000, Val F1: 0.0000
LR: 5.00e-04
--------------------------------------------------------------------------------
Епоха 2/80
Навчання епоха 2: 100%|██████████| 4/4 [00:27<00:00,  6.79s/it, loss=4.35, acc=0.0496, lr=0.0005]
Валідація з TTA: 100%|██████████| 1/1 [00:26<00:00, 26.92s/it]
Train Loss: 3.8849, Train Acc: 0.0496
Val Loss: 2.7980, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.99e-04
--------------------------------------------------------------------------------
Епоха 3/80
Навчання епоха 3: 100%|██████████| 4/4 [00:31<00:00,  7.85s/it, loss=3.57, acc=0.0625, lr=0.000499]
Валідація з TTA: 100%|██████████| 1/1 [00:29<00:00, 29.85s/it]
Train Loss: 3.3532, Train Acc: 0.0625
Val Loss: 2.8437, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.98e-04
--------------------------------------------------------------------------------
Епоха 4/80
Навчання епоха 4: 100%|██████████| 4/4 [00:29<00:00,  7.49s/it, loss=3.14, acc=0.0978, lr=0.000498]
Валідація з TTA: 100%|██████████| 1/1 [00:27<00:00, 27.86s/it]
Train Loss: 3.1680, Train Acc: 0.0978
Val Loss: 2.8957, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.97e-04
--------------------------------------------------------------------------------
Епоха 5/80
Навчання епоха 5: 100%|██████████| 4/4 [00:18<00:00,  4.51s/it, loss=4.16, acc=0.0814, lr=0.000497]
Валідація з TTA: 100%|██████████| 1/1 [00:28<00:00, 28.19s/it]
Train Loss: 3.3780, Train Acc: 0.0814
Val Loss: 2.9529, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.95e-04
--------------------------------------------------------------------------------
Епоха 6/80
Навчання епоха 6: 100%|██████████| 4/4 [00:26<00:00,  6.62s/it, loss=3.92, acc=0.104, lr=0.000495] 
Валідація з TTA: 100%|██████████| 1/1 [00:28<00:00, 28.90s/it]
Train Loss: 3.3810, Train Acc: 0.1041
Val Loss: 2.9983, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.93e-04
--------------------------------------------------------------------------------
Епоха 7/80
Навчання епоха 7: 100%|██████████| 4/4 [00:28<00:00,  7.17s/it, loss=4.34, acc=0.0545, lr=0.000493]
Валідація з TTA: 100%|██████████| 1/1 [00:26<00:00, 26.33s/it]
Train Loss: 3.4716, Train Acc: 0.0545
Val Loss: 3.0283, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.91e-04
--------------------------------------------------------------------------------
Епоха 8/80
Навчання епоха 8: 100%|██████████| 4/4 [00:25<00:00,  6.42s/it, loss=2.69, acc=0.0822, lr=0.000491]
Валідація з TTA: 100%|██████████| 1/1 [00:28<00:00, 28.17s/it]
Train Loss: 3.2493, Train Acc: 0.0822
Val Loss: 3.0628, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.88e-04
--------------------------------------------------------------------------------
Епоха 9/80
Розморожування рівень 1
Навчання епоха 9: 100%|██████████| 4/4 [00:19<00:00,  4.88s/it, loss=3.33, acc=0.0343, lr=0.000488]
Валідація з TTA: 100%|██████████| 1/1 [00:18<00:00, 18.09s/it]
Train Loss: 3.3769, Train Acc: 0.0343
Val Loss: 2.9836, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.85e-04
--------------------------------------------------------------------------------
Епоха 10/80
Навчання епоха 10: 100%|██████████| 4/4 [00:18<00:00,  4.54s/it, loss=4.22, acc=0.0625, lr=0.000485]
Валідація з TTA: 100%|██████████| 1/1 [00:17<00:00, 17.67s/it]
Train Loss: 3.8886, Train Acc: 0.0625
Val Loss: 2.9647, Val Acc: 0.0833, Val F1: 0.0208
LR: 4.81e-04
✅ Нова найкраща модель! F1: 0.0208
--------------------------------------------------------------------------------
Епоха 11/80
Навчання епоха 11: 100%|██████████| 4/4 [00:22<00:00,  5.56s/it, loss=3.02, acc=0.000533, lr=0.000481]
Валідація з TTA: 100%|██████████| 1/1 [00:19<00:00, 19.04s/it]
Train Loss: 3.4455, Train Acc: 0.0005
Val Loss: 2.9825, Val Acc: 0.0833, Val F1: 0.0152
LR: 4.77e-04
--------------------------------------------------------------------------------
Епоха 12/80
Навчання епоха 12: 100%|██████████| 4/4 [00:19<00:00,  4.89s/it, loss=4.11, acc=0.0658, lr=0.000477]
Валідація з TTA: 100%|██████████| 1/1 [00:18<00:00, 18.33s/it]
Train Loss: 3.6679, Train Acc: 0.0658
Val Loss: 3.0044, Val Acc: 0.0000, Val F1: 0.0000
LR: 4.73e-04
--------------------------------------------------------------------------------
Епоха 13/80
Навчання епоха 13: 100%|██████████| 4/4 [00:22<00:00,  5.57s/it, loss=2.56, acc=0.0787, lr=0.000473]
Валідація з TTA:   0%|          | 0/1 [00:00<?, ?it/s]
