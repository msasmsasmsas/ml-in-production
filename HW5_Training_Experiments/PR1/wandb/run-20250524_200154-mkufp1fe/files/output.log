Використовуємо пристрій: cpu
Створення покращених завантажувачів даних...
Завантаження датасету для типу ризику: diseases
Завантажено ризиків: 156
Завантажено зображень: 152
Знайдено класів: 102
Валідних зображень: 152
Загальна кількість зразків: 152
Розподіл по класах (топ-10):
  Альтернариоз зерна: 3 зразків
  Бурая ржавчина: 3 зразків
  Гельминтоспориозная корневая гниль: 3 зразків
  Гибеллиноз пшеницы: 3 зразків
  Желтая ржавчина: 3 зразків
  Мучнистая роса: 3 зразків
  Оливковая плесень: 3 зразків
  Офиоболезная корневая гниль: 3 зразків
  Пиренофороз: 3 зразків
  Плесневение семян: 3 зразків
Після фільтрації: 60 зразків
Завантаження датасету для типу ризику: diseases
Завантажено ризиків: 156
Завантажено зображень: 152
Знайдено класів: 102
Валідних зображень: 152
Завантаження датасету для типу ризику: diseases
Завантажено ризиків: 156
Завантажено зображень: 152
Знайдено класів: 102
Валідних зображень: 152
Фінальна статистика:
  Тренувальна вибірка: 45 зразків
  Валідаційна вибірка: 15 зразків
  Кількість класів: 20
Створення покращеної моделі mobilenet_v2
E:\ml-in-production\HW2-Infrastructure-setup\venv\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning:

The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.

E:\ml-in-production\HW2-Infrastructure-setup\venv\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning:

Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=MobileNet_V2_Weights.IMAGENET1K_V1`. You can also use `weights=MobileNet_V2_Weights.DEFAULT` to get the most up-to-date weights.

Downloading: "https://download.pytorch.org/models/mobilenet_v2-b0353104.pth" to C:\Users\msts/.cache\torch\hub\checkpoints\mobilenet_v2-b0353104.pth
100%|██████████| 13.6M/13.6M [00:01<00:00, 10.1MB/s]
Backbone заморожено на перші 5 епох
E:\ml-in-production\HW2-Infrastructure-setup\venv\Lib\site-packages\torch\optim\lr_scheduler.py:28: UserWarning:

The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
Епоха 1/50

Навчання епоха 1: 100%|██████████| 2/2 [00:20<00:00, 10.36s/it, loss=3.24, acc=0.0625, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.15s/it]
Train Loss: 3.0946, Train Acc: 0.0625
Val Loss: 3.1041, Val Acc: 0.0000, Val F1: 0.0000
LR: 1.00e-04
------------------------------------------------------------
Епоха 2/50
Навчання епоха 2: 100%|██████████| 2/2 [00:19<00:00,  9.71s/it, loss=2.87, acc=0.125, lr=0.0001] 
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.47s/it]
Train Loss: 3.0963, Train Acc: 0.1250
Val Loss: 3.1026, Val Acc: 0.0000, Val F1: 0.0000
LR: 1.00e-04
------------------------------------------------------------
Епоха 3/50
Навчання епоха 3: 100%|██████████| 2/2 [00:19<00:00,  9.93s/it, loss=3.16, acc=0.125, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.63s/it]
Train Loss: 3.1385, Train Acc: 0.1250
Val Loss: 3.0896, Val Acc: 0.0000, Val F1: 0.0000
LR: 1.00e-04
------------------------------------------------------------
Епоха 4/50
Навчання епоха 4: 100%|██████████| 2/2 [00:19<00:00,  9.96s/it, loss=3.19, acc=0.0938, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.26s/it]
Train Loss: 3.0704, Train Acc: 0.0938
Val Loss: 3.0810, Val Acc: 0.0667, Val F1: 0.0121
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.0121
------------------------------------------------------------
Епоха 5/50
Навчання епоха 5: 100%|██████████| 2/2 [00:21<00:00, 10.81s/it, loss=3.07, acc=0.0312, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.40s/it]
Train Loss: 3.0933, Train Acc: 0.0312
Val Loss: 3.0780, Val Acc: 0.0667, Val F1: 0.0148
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.0148
------------------------------------------------------------
Епоха 6/50
Backbone розморожено!
Навчання епоха 6: 100%|██████████| 2/2 [00:24<00:00, 12.06s/it, loss=2.92, acc=0.0938, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:20<00:00, 20.30s/it]
Train Loss: 3.0055, Train Acc: 0.0938
Val Loss: 2.9979, Val Acc: 0.0667, Val F1: 0.0133
LR: 1.00e-04
------------------------------------------------------------
Епоха 7/50
Навчання епоха 7: 100%|██████████| 2/2 [00:22<00:00, 11.45s/it, loss=2.74, acc=0.188, lr=0.0001] 
Валідація: 100%|██████████| 1/1 [00:21<00:00, 21.31s/it]
Train Loss: 2.8185, Train Acc: 0.1875
Val Loss: 2.9105, Val Acc: 0.2000, Val F1: 0.1481
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.1481
------------------------------------------------------------
Епоха 8/50
Навчання епоха 8: 100%|██████████| 2/2 [00:22<00:00, 11.09s/it, loss=2.73, acc=0.219, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:20<00:00, 20.95s/it]
Train Loss: 2.6590, Train Acc: 0.2188
Val Loss: 2.8303, Val Acc: 0.3333, Val F1: 0.2857
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.2857
------------------------------------------------------------
Епоха 9/50
Навчання епоха 9: 100%|██████████| 2/2 [00:20<00:00, 10.26s/it, loss=2.56, acc=0.375, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.39s/it]
Train Loss: 2.5886, Train Acc: 0.3750
Val Loss: 2.7403, Val Acc: 0.4000, Val F1: 0.3556
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.3556
------------------------------------------------------------
Епоха 10/50
Навчання епоха 10: 100%|██████████| 2/2 [00:24<00:00, 12.28s/it, loss=2.06, acc=0.438, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.51s/it]
Train Loss: 2.3120, Train Acc: 0.4375
Val Loss: 2.6533, Val Acc: 0.4667, Val F1: 0.4222
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.4222
------------------------------------------------------------
Епоха 11/50
Навчання епоха 11: 100%|██████████| 2/2 [00:19<00:00,  9.97s/it, loss=2.26, acc=0.531, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.65s/it]
Train Loss: 2.2229, Train Acc: 0.5312
Val Loss: 2.5702, Val Acc: 0.4667, Val F1: 0.4667
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.4667
------------------------------------------------------------
Епоха 12/50
Навчання епоха 12: 100%|██████████| 2/2 [00:20<00:00, 10.01s/it, loss=1.84, acc=0.719, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:17<00:00, 17.25s/it]
Train Loss: 2.0248, Train Acc: 0.7188
Val Loss: 2.4972, Val Acc: 0.4667, Val F1: 0.4667
LR: 1.00e-04
------------------------------------------------------------
Епоха 13/50
Навчання епоха 13: 100%|██████████| 2/2 [00:22<00:00, 11.31s/it, loss=1.78, acc=0.656, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.45s/it]
Train Loss: 1.9475, Train Acc: 0.6562
Val Loss: 2.4144, Val Acc: 0.6000, Val F1: 0.6000
LR: 1.00e-04
✅ Нова найкраща модель! F1: 0.6000
------------------------------------------------------------
Епоха 14/50
Навчання епоха 14: 100%|██████████| 2/2 [00:21<00:00, 10.78s/it, loss=1.79, acc=0.719, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.51s/it]
Train Loss: 1.8295, Train Acc: 0.7188
Val Loss: 2.3308, Val Acc: 0.6000, Val F1: 0.6000
LR: 1.00e-04
------------------------------------------------------------
Епоха 15/50
Навчання епоха 15: 100%|██████████| 2/2 [00:23<00:00, 11.60s/it, loss=1.54, acc=0.812, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.75s/it]
Train Loss: 1.6408, Train Acc: 0.8125
Val Loss: 2.2488, Val Acc: 0.6000, Val F1: 0.6000
LR: 1.00e-04
------------------------------------------------------------
Епоха 16/50
Навчання епоха 16: 100%|██████████| 2/2 [00:22<00:00, 11.40s/it, loss=1.45, acc=0.781, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.35s/it]
Train Loss: 1.6145, Train Acc: 0.7812
Val Loss: 2.1792, Val Acc: 0.6000, Val F1: 0.6000
LR: 1.00e-04
------------------------------------------------------------
Епоха 17/50
Навчання епоха 17: 100%|██████████| 2/2 [00:22<00:00, 11.18s/it, loss=1.62, acc=0.844, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.70s/it]
Train Loss: 1.4686, Train Acc: 0.8438
Val Loss: 2.1156, Val Acc: 0.6000, Val F1: 0.6000
LR: 1.00e-04
------------------------------------------------------------
Епоха 18/50
Навчання епоха 18: 100%|██████████| 2/2 [00:23<00:00, 11.64s/it, loss=1.52, acc=0.875, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.21s/it]
Train Loss: 1.3954, Train Acc: 0.8750
Val Loss: 2.0392, Val Acc: 0.6000, Val F1: 0.6000
LR: 1.00e-04
------------------------------------------------------------
Епоха 19/50
Навчання епоха 19: 100%|██████████| 2/2 [00:22<00:00, 11.33s/it, loss=1.16, acc=0.875, lr=0.0001]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.46s/it]
Train Loss: 1.3784, Train Acc: 0.8750
Val Loss: 1.9598, Val Acc: 0.6000, Val F1: 0.6000
LR: 5.00e-05
------------------------------------------------------------
Епоха 20/50
Навчання епоха 20: 100%|██████████| 2/2 [00:21<00:00, 10.58s/it, loss=1.38, acc=0.875, lr=5e-5]
Валідація: 100%|██████████| 1/1 [00:19<00:00, 19.31s/it]
Train Loss: 1.3894, Train Acc: 0.8750
Val Loss: 1.9106, Val Acc: 0.6000, Val F1: 0.6000
LR: 5.00e-05
------------------------------------------------------------
Епоха 21/50
Навчання епоха 21: 100%|██████████| 2/2 [00:22<00:00, 11.38s/it, loss=1.23, acc=0.875, lr=5e-5]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.40s/it]
Train Loss: 1.2648, Train Acc: 0.8750
Val Loss: 1.8590, Val Acc: 0.6000, Val F1: 0.6000
LR: 5.00e-05
------------------------------------------------------------
Епоха 22/50
Навчання епоха 22: 100%|██████████| 2/2 [00:20<00:00, 10.45s/it, loss=1.13, acc=0.969, lr=5e-5]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.19s/it]
Train Loss: 1.1140, Train Acc: 0.9688
Val Loss: 1.8100, Val Acc: 0.6000, Val F1: 0.6000
LR: 5.00e-05
------------------------------------------------------------
Епоха 23/50
Навчання епоха 23: 100%|██████████| 2/2 [00:20<00:00, 10.34s/it, loss=1.19, acc=0.938, lr=5e-5]
Валідація: 100%|██████████| 1/1 [00:18<00:00, 18.10s/it]
Train Loss: 1.2431, Train Acc: 0.9375
Val Loss: 1.7624, Val Acc: 0.6000, Val F1: 0.6000
LR: 5.00e-05
Early stopping після 23 епох

🎉 Навчання завершено!
Найкращий валідаційний F1: 0.6000
